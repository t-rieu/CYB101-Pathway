# Malware Analysis

**Malware**
- **Virus -** malicious code that replicates itself on the computer.
  - It has to be activated before it can spread.
- **Worms -** malicious code that affects the computer.
  - It is self-replicating and can email itself to others.
- **Trojan horse -** malware is concealed within a seemingly useful program. The malware is executed once the program is run.
- **Ransomware -** llocks access to assets until a sum is paid.
  - It mainly targets government, education, banks, manufacturing, energy & utilities.
 
**Blended threat -** combines multiple threats into one package. *Eg. using a trojan horse to sneak in a virus.*

**Antivirus software -** a type of program that prevents, detects, and eradicates malware.
- **Malware signature -** disables software with sequences of code typical to a specific piece of malware.
  - It can only protect against known threats.
- **System monitoring -** the software can monitor a system’s behavior.
  - Atypical behavior is flagged. *Eg. unusually large increase in data usage, and attempts to access a large number of files.*
  - Provides real-time protection.
 
**Malware analysis**
- **Process isolation -** process address spaces are separated to ensure other processes can’t tamper with each other.
- **Virtual machine -** simulates all aspects of a hardware device.
  - Allows users to test how malware interacts with file systems, registry, etc.
  - However, some malware can detect VMs and behave differently inside them.
  - There is some risk of an escape attack.
- **Docker containers -** a package of software that includes everything needed to run an application.
  - It provides isolation from host systems but there can still be a risk of an escape attack because the OS kernel is shared between containers and host.
- ** Sandboxes -** opens up files in a carefully isolated environment and observes the effects of the file.
  - Threat actors can evade sandboxing by delaying malware execution because sandboxes typically run malware for a short time. Delaying it prevents the malware from exhibiting malicious behavior that the sandbox analyzes.
 
**Forensic analysis -** analysis of digital evidence and investigation of security incidents.
  - Common artifacts include windows event logs, file metadata, deleted files, browser history, cookies, cache, download history, firewall logs, etc.
  - **PCAP -** a file that contains packet data.
    - Applications such as Wireshark are crucial to analyze pcaps.
  - Forensic analysts have to ask questions such as:
    - What damage has been done?
    - Who was the perpetrator? How were the security measures passed?
    - Did the perpetrator leave anything behind such as a new account or malware?
    - Is there enough data to reproduce the attack and test it against a new control(s)?
  - In order to properly identify suspicious network activities, there are [reference files](https://wiki.wireshark.org/samplecaptures) for standard network behaviors.
  - Suspicious activities include:
    - Unusual communication pairs (nodes that don’t typically communicate suddenly are).
    - Unusual protocols and ports (understand what ports are open and active in the network. Unfamiliar open ports are suspicious).
    - Excessive failed connections.
    - Suspicious inbound connections.
   
## Project

